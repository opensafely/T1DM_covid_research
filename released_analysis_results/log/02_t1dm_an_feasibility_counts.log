--------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\alex\T1DM_covid_research/output/log/02_t1dm_an_feasibility_counts.log
  log type:  text
 opened on:  12 Sep 2020, 17:48:16

. 
. use "$Tempdir/analysis_dataset.dta", clear

. safecount
  21,749,804

. safetab baseline_t1dm

baseline_t1 |
         dm |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 21,613,200       99.37       99.37
          1 |    136,604        0.63      100.00
------------+-----------------------------------
      Total | 21,749,804      100.00

. 
. local var "incident_t1dm monthbefore_t1dm"

. foreach i of local var {
  2.         safetab `i' if baseline_t1dm==0
  3.         safetab `i' covid if baseline_t1dm==0, col
  4.         bysort agecat: safetab `i' covid if baseline_t1dm==0, col
  5.         bysort sex: safetab `i' covid if baseline_t1dm==0, col
  6.         bysort eth5: safetab `i' covid if baseline_t1dm==0, col
  7.         bysort imd: safetab `i' covid if baseline_t1dm==0, col
  8.         bysort region: safetab `i' covid if baseline_t1dm==0, col
  9. }

incident_t1 |
         dm |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 21,613,173      100.00      100.00
          1 |         27        0.00      100.00
------------+-----------------------------------
      Total | 21,613,200      100.00

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |21,502,026    111,147 |21,613,173 
           |    100.00      99.98 |    100.00 
-----------+----------------------+----------
         1 |         0         27 |        27 
           |      0.00       0.02 |      0.00 
-----------+----------------------+----------
     Total |21,502,026    111,174 |21,613,200 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> agecat = Children

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> agecat = Adults 18-45

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,611,737     37,967 | 7,649,704 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0         12 |        12 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total | 7,611,737     37,979 | 7,649,716 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> agecat = Adults 46-105

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 9,665,295     68,422 | 9,733,717 
           |    100.00      99.98 |    100.00 
-----------+----------------------+----------
         1 |         0         12 |        12 
           |      0.00       0.02 |      0.00 
-----------+----------------------+----------
     Total | 9,665,295     68,434 | 9,733,729 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> sex = F

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |10,714,916     62,840 |10,777,756 
           |    100.00      99.98 |    100.00 
-----------+----------------------+----------
         1 |         0         14 |        14 
           |      0.00       0.02 |      0.00 
-----------+----------------------+----------
     Total |10,714,916     62,854 |10,777,770 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> sex = M

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |10,787,110     48,307 |10,835,417 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0         13 |        13 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total |10,787,110     48,320 |10,835,430 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = White

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |12,976,703     63,462 |13,040,165 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0         18 |        18 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total |12,976,703     63,480 |13,040,183 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = South Asian

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Black

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Mixed

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |   264,988      1,285 |   266,273 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |   264,988      1,285 |   266,273 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Other

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |   389,327      1,771 |   391,098 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |   389,327      1,771 |   391,098 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Unknown

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> imd = 1 least deprived

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> imd = 2

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 4,324,483     19,373 | 4,343,856 
           |    100.00      99.96 |    100.00 
-----------+----------------------+----------
         1 |         0          7 |         7 
           |      0.00       0.04 |      0.00 
-----------+----------------------+----------
     Total | 4,324,483     19,380 | 4,343,863 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> imd = 3

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 4,301,478     20,824 | 4,322,302 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0          7 |         7 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total | 4,301,478     20,831 | 4,322,309 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> imd = 4

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> imd = 5 most deprived

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> imd = Unknown

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |   193,528        948 |   194,476 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |   193,528        948 |   194,476 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> region = 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |     3,473         19 |     3,492 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |     3,473         19 |     3,492 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> region = East

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = East Midlands

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 3,768,093     21,015 | 3,789,108 
           |    100.00      99.96 |    100.00 
-----------+----------------------+----------
         1 |         0          9 |         9 
           |      0.00       0.04 |      0.00 
-----------+----------------------+----------
     Total | 3,768,093     21,024 | 3,789,117 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> region = London

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = North East

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = North West

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

incident_t |         covid
       1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 1,903,371     12,441 | 1,915,812 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total | 1,903,371     12,441 | 1,915,812 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> region = South East

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = South West

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = West Midlands

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = Yorkshire and The Humber

**TABLE OF incident_t1dm covid REDACTED DUE TO SMALL N**


monthbefore |
      _t1dm |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 21,613,168      100.00      100.00
          1 |         32        0.00      100.00
------------+-----------------------------------
      Total | 21,613,200      100.00

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |21,502,026    111,142 |21,613,168 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0         32 |        32 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total |21,502,026    111,174 |21,613,200 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> agecat = Children

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> agecat = Adults 18-45

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 7,611,737     37,965 | 7,649,702 
           |    100.00      99.96 |    100.00 
-----------+----------------------+----------
         1 |         0         14 |        14 
           |      0.00       0.04 |      0.00 
-----------+----------------------+----------
     Total | 7,611,737     37,979 | 7,649,716 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> agecat = Adults 46-105

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 9,665,295     68,419 | 9,733,714 
           |    100.00      99.98 |    100.00 
-----------+----------------------+----------
         1 |         0         15 |        15 
           |      0.00       0.02 |      0.00 
-----------+----------------------+----------
     Total | 9,665,295     68,434 | 9,733,729 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> sex = F

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |10,714,916     62,837 |10,777,753 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0         17 |        17 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total |10,714,916     62,854 |10,777,770 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> sex = M

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |10,787,110     48,305 |10,835,415 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0         15 |        15 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total |10,787,110     48,320 |10,835,430 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = White

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |12,976,703     63,458 |13,040,161 
           |    100.00      99.97 |    100.00 
-----------+----------------------+----------
         1 |         0         22 |        22 
           |      0.00       0.03 |      0.00 
-----------+----------------------+----------
     Total |12,976,703     63,480 |13,040,183 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = South Asian

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Black

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Mixed

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |   264,988      1,285 |   266,273 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |   264,988      1,285 |   266,273 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Other

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |   389,327      1,771 |   391,098 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |   389,327      1,771 |   391,098 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> eth5 = Unknown

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> imd = 1 least deprived

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> imd = 2

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 4,324,483     19,372 | 4,343,855 
           |    100.00      99.96 |    100.00 
-----------+----------------------+----------
         1 |         0          8 |         8 
           |      0.00       0.04 |      0.00 
-----------+----------------------+----------
     Total | 4,324,483     19,380 | 4,343,863 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> imd = 3

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 4,301,478     20,823 | 4,322,301 
           |    100.00      99.96 |    100.00 
-----------+----------------------+----------
         1 |         0          8 |         8 
           |      0.00       0.04 |      0.00 
-----------+----------------------+----------
     Total | 4,301,478     20,831 | 4,322,309 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> imd = 4

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> imd = 5 most deprived

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 4,081,126     27,835 | 4,108,961 
           |    100.00      99.98 |    100.00 
-----------+----------------------+----------
         1 |         0          6 |         6 
           |      0.00       0.02 |      0.00 
-----------+----------------------+----------
     Total | 4,081,126     27,841 | 4,108,967 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> imd = Unknown

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |   193,528        948 |   194,476 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |   193,528        948 |   194,476 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> region = 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 |     3,473         19 |     3,492 
           |    100.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |     3,473         19 |     3,492 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> region = East

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = East Midlands

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

monthbefor |         covid
    e_t1dm |         0          1 |     Total
-----------+----------------------+----------
         0 | 3,768,093     21,015 | 3,789,108 
           |    100.00      99.96 |    100.00 
-----------+----------------------+----------
         1 |         0          9 |         9 
           |      0.00       0.04 |      0.00 
-----------+----------------------+----------
     Total | 3,768,093     21,024 | 3,789,117 
           |    100.00     100.00 |    100.00 

--------------------------------------------------------------------------------------------------------------------------------
-> region = London

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = North East

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = North West

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = South East

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = South West

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = West Midlands

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


--------------------------------------------------------------------------------------------------------------------------------
-> region = Yorkshire and The Humber

**TABLE OF monthbefore_t1dm covid REDACTED DUE TO SMALL N**


. 
. preserve

. collapse (count) population=covid  (sum) covid baseline_t1dm incident_t1dm monthbefore_t1dm, by(agecat)

. gen var=1

. save "$Tempdir/table0_overall.dta", replace
file E:\alex\T1DM_covid_research/output/tempdata/table0_overall.dta saved

. restore

. 
. preserve

. collapse (count) population=covid  (sum) covid baseline_t1dm incident_t1dm monthbefore_t1dm, by(agecat sex)

. gen var=2

. save "$Tempdir/table0_sex.dta", replace
file E:\alex\T1DM_covid_research/output/tempdata/table0_sex.dta saved

. restore

. 
. preserve

. collapse (count) population=covid  (sum) covid baseline_t1dm incident_t1dm monthbefore_t1dm, by(agecat eth5)

. gen var=3

. save "$Tempdir/table0_eth.dta", replace
file E:\alex\T1DM_covid_research/output/tempdata/table0_eth.dta saved

. restore

. 
. *combine datasets to create a simple table of proportions and counts
. use "$Tempdir/table0_overall.dta", clear

. append using "$Tempdir/table0_sex.dta"
(label agecat already defined)

. append using "$Tempdir/table0_eth.dta"
(label agecat already defined)

. destring var, replace
var already numeric; no replace

. 
. label define var 1"Overall" 2"Sex" 3"Eth"

. label values var var

. sort agecat var 

. 
. *create proportions
. gen incident_t1dm_percent=incident_t1dm/covid*100

. gen monthbefore_t1dm_percent=monthbefore_t1dm/covid*100

. gen covid_percent=covid/baseline_t1dm*100

. 
. label var monthbefore_t1dm_percent "% of people with COVID who had T1DM in 30 days before or anytime after to infection"
note: label truncated to 80 characters

. label var incident_t1dm_percent "% of people with COVID who had T1DM after"

. label var covid_percent "% of people with T1DM who had COVID after T1DM diagnosis"

. 
. *save dataset for use as table
. outsheet using "$Tabfigdir/02_t1dm_an_feasibility_counts.txt", replace

. save "$Tempdir/02_t1dm_an_feasibility_count.dta", replace
file E:\alex\T1DM_covid_research/output/tempdata/02_t1dm_an_feasibility_count.dta saved

. insheet using "$Tabfigdir/02_t1dm_an_feasibility_counts.txt", clear
(12 vars, 27 obs)

. 
end of do-file

. 
end of do-file

